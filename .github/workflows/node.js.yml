# ğŸ”§ PLEXCOM CI Pipeline
# This workflow builds, tests, and validates the full PLEXCOM GUI + Core CLI
# across stable Node.js versions. It installs dependencies, caches modules,
# and ensures all .plxcm command modules are executable-ready.

name: PLEXCOM Build & Test CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  plexcom-ci:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [18.x, 20.x, 22.x]
        # â„¹ï¸ Supports Node.js LTS and current tiers for forward/backward compatibility

    steps:
    - name: â¬‡ï¸ Checkout Source Code
      uses: actions/checkout@v4

    - name: âš™ï¸ Setup Node.js (${{ matrix.node-version }})
      uses: actions/setup-node@v4
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'

    - name: ğŸ“¦ Install Dependencies
      run: npm ci

    - name: ğŸ§± Build PLEXCOM Interface
      run: npm run build --if-present

    - name: âœ… Run Core Tests (GUI + Modules)
      run: npm test

    - name: ğŸ“ Validate .plxcm Modules
      run: |
        echo "ğŸ” Scanning modules directory..."
        for file in modules/*.plxcm; do
          echo "âœ”ï¸  Found module: $file"
        done
